<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>24h Aviation Analog Clock</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#111111">

  <!-- iOS: ホーム画面用 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="24h Clock">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">

  <style>
    body{
      margin:0;
      height:100vh;
      display:grid;
      place-items:center;
      background:#111;
      font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
    }

    .clock{
      width:min(86vw, 380px);
      height:min(86vw, 380px);
      border:8px solid #fff;
      border-radius:50%;
      position:relative;
      overflow:hidden;
      background: radial-gradient(circle at 50% 45%, #070707, #000 60%);
    }

    /* ===== AM / PM リング（ローカルの昼夜） ===== */
    .ampm-ring{
      position:absolute;
      inset:14px;
      border-radius:50%;
      background: conic-gradient(
        rgba(80,160,255,0.35) 0deg 180deg,   /* AM */
        rgba(255,140,80,0.35) 180deg 360deg  /* PM */
      );
      -webkit-mask: radial-gradient(transparent 64%, #000 66%);
              mask: radial-gradient(transparent 64%, #000 66%);
      pointer-events:none;
      z-index:1;
    }

    /* ===== 計器ラベル ===== */
    .panel-label{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      color:rgba(255,255,255,0.85);
      font-weight:800;
      letter-spacing:0.18em;
      font-size:12px;
      text-shadow: 0 0 10px rgba(120,220,255,0.25);
      pointer-events:none;
      z-index:4;
      user-select:none;
    }
    .panel-label.top{ top:34px; }
    .panel-label.bottom{ bottom:76px; font-size:18px; opacity:0.75; }

    /* ===== 目盛り・数字 ===== */
    .dial{
      position:absolute;
      inset:0;
      border-radius:50%;
      pointer-events:none;
      z-index:2;
    }

    .tick.minute{
      position:absolute;
      left:50%;
      top:50%;
      width:1px;
      height:8px;
      background:rgba(255,255,255,0.45);
      transform-origin: 0 170px;
      border-radius:1px;
    }
    .tick.five{
      position:absolute;
      left:50%;
      top:50%;
      width:2px;
      height:12px;
      background:rgba(255,255,255,0.7);
      transform-origin: 0 170px;
      border-radius:2px;
    }
    .tick.hour{
      position:absolute;
      left:50%;
      top:50%;
      width:3px;
      height:18px;
      background:rgba(255,255,255,0.95);
      transform-origin: 0 170px;
      border-radius:2px;
    }

    .num{
      position:absolute;
      left:50%;
      top:50%;
      color:rgba(255,255,255,0.88);
      font-size:14px;
      font-variant-numeric: tabular-nums;
      user-select:none;
//      white-space:nowrap;
      transform: translate(-50%, -50%);
    }
    .num.major{
      font-size:16px;
      font-weight:700;
      color:#fff;
    }

    /* ===== AM/PM ラベル（任意） ===== */
    .labels{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 80px;
      color:rgba(255,255,255,0.4);
      font-weight:700;
      letter-spacing:0.1em;
      pointer-events:none;
      z-index:3;
      user-select:none;
    }
    .labels span{ font-size:24px; }

    /* ===== 針 ===== */
    .hand{
      position:absolute;
      bottom:50%;
      left:50%;
      transform-origin: bottom;
      transform: translateX(-50%) rotate(0deg);
      border-radius:4px;
      z-index:6;
    }

    .hour{
      width:6px;
      height:95px;
      background:#fff;
      z-index:7;
    }

    .minute{
      width:4px;
      height:135px;
      background:#ddd;
      z-index:8;
    }

    /* UTC針（Zulu） */
    .utc{
      width:3px;
      height:120px;
      background: rgba(255,135,35,0.95);
      z-index:8;               /* 分針と同じ層に */
      border-radius:3px;
    }

    /* UTC針の先端に小さな矢印（擬似要素） */
    .utc::after{
      content:"";
      position:absolute;
      left:50%;
      top:-10px;
      transform:translateX(-50%);
      width:0;
      height:0;
      border-left:6px solid transparent;
      border-right:6px solid transparent;
      border-bottom:10px solid rgba(120,220,255,0.95);
      filter: drop-shadow(0 0 8px rgba(120,220,255,0.35));
    }

    .second{
      width:2px;
      height:155px;
      background:#ff4d4d;
      z-index:9;
    }

    .center{
      position:absolute;
      width:12px;
      height:12px;
      background:#fff;
      border-radius:50%;
      top:50%;
      left:50%;
      transform:translate(-50%, -50%);
      z-index:10;
      box-shadow:0 0 0 3px rgba(0,0,0,0.6);
    }

    /* ===== 夜光（ルミノバ風） ===== */
    .tick.minute, .tick.five, .tick.hour, .num, .hour, .minute{
      filter: drop-shadow(0 0 6px rgba(120,220,255,0.25));
    }
    .num.major{
      filter: drop-shadow(0 0 8px rgba(120,220,255,0.35));
    }
    .utc{
      filter: drop-shadow(0 0 10px rgba(120,220,255,0.45));
    }
    .second{
      filter: drop-shadow(0 0 6px rgba(255,80,80,0.35));
    }
  </style>
</head>

<body>
  <div class="clock" aria-label="24時間アナログ時計（ローカル+UTC）">
    <div class="ampm-ring"></div>

    <div class="bezel"></div>
    <div class="glass"></div>

<!--
    <div class="panel-label top">24H</div>
-->
    <div class="panel-label bottom" id="utcLabel"></div>


    <div class="dial" id="dial"></div>

    <div class="labels">
      <span>PM</span>
      <span>AM</span>
    </div>

    <div class="hand hour" id="hour"></div>
    <div class="hand minute" id="minute"></div>

    <!-- UTC針 -->
    <div class="hand utc" id="utc"></div>

    <div class="hand second" id="second"></div>
    <div class="center"></div>
  </div>

  <script>
    // ===== 文字盤生成 =====
    (function buildDial(){
      const dial = document.getElementById("dial");
      const tickRadius = 170;
      const numRadius  = 145;

      // 分目盛り（60本）
      for(let m=0; m<60; m++){
        const tick = document.createElement("div");
        tick.className = (m % 5 === 0) ? "tick five" : "tick minute";
        const deg = m * 6; // 360/60
        tick.style.transform = `translate(-50%, -${tickRadius}px) rotate(${deg}deg)`;
        dial.appendChild(tick);
      }

      // 時間目盛り（24本）
      for(let h=0; h<24; h++){
        const tick = document.createElement("div");
        tick.className = "tick hour";
        const deg = h * 15; // 360/24
        tick.style.transform = `translate(-50%, -${tickRadius}px) rotate(${deg}deg)`;
        dial.appendChild(tick);
      }

      // 数字（0〜23）
      for(let h=0; h<24; h++){
        const num = document.createElement("div");
        num.className = "num" + (h % 6 === 0 ? " major" : "");
        num.textContent = h;

        // 0時を上に（-90°）
        const rad = (h * 15 - 90) * Math.PI / 180;
        const x = Math.cos(rad) * numRadius;
        const y = Math.sin(rad) * numRadius;

        num.style.transform = `translate(${x}px, ${y}px) translate(-50%, -50%)`;
        dial.appendChild(num);
      }
    })();

    // ===== 時計更新（スムーズ）=====
    function updateClock(){
      const now = new Date();

      // ローカル
      const ms   = now.getMilliseconds();
      const sec  = now.getSeconds() + ms / 1000;
      const min  = now.getMinutes() + sec / 60;
      const hour = now.getHours() + min / 60; // 24h

      // UTC（Zulu）
      const utcSec  = now.getUTCSeconds() + ms / 1000;
      const utcMin  = now.getUTCMinutes() + utcSec / 60;
      const utcHour = now.getUTCHours() + utcMin / 60; // 24h

      // 角度
      const secDeg   = sec * 6;
      const minDeg   = min * 6;
      const hourDeg  = hour * 15;     // 360/24
      const utcDeg   = utcHour * 15;  // 360/24

      // 針反映
      document.getElementById("second").style.transform =
        `translateX(-50%) rotate(${secDeg}deg)`;
      document.getElementById("minute").style.transform =
        `translateX(-50%) rotate(${minDeg}deg)`;
      document.getElementById("hour").style.transform =
        `translateX(-50%) rotate(${hourDeg}deg)`;

      // UTC針（Zulu）
      document.getElementById("utc").style.transform =
        `translateX(-50%) rotate(${utcDeg}deg)`;

      requestAnimationFrame(updateClock);
    }
    requestAnimationFrame(updateClock);

    // ===== ラベルにUTC時刻を小さく表示（おまけ）=====
    const utcLabel = document.getElementById("utcLabel");
    function updateUtcLabel(){
      const now = new Date();
      const h = String(now.getUTCHours()).padStart(2,"0");
      const m = String(now.getUTCMinutes()).padStart(2,"0");
      utcLabel.textContent = `${h}:${m}Z`;
      requestAnimationFrame(updateUtcLabel);
    }
    requestAnimationFrame(updateUtcLabel);

    // ===== Service Worker 登録（https or localhost が必要）=====
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(console.error);
      });
    }
  </script>
</body>
</html>
